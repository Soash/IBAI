{% extends 'base.html' %}

{% load static i18n %}

{% block title %}Login/Register{% endblock %}


{% block extra_css %}
<style>
    #id_profile_picture{
        padding-top: 10px;
    }
</style>
{% endblock extra_css %}
    

{% block content %}
{% comment %} {% include 'partials/theme-switch.html' %} {% endcomment %}

<main class="main_wrapper overflow-hidden">

    <!-- topbar__section__stert -->
    {% include 'partials/top-banner.html' %}
    <!-- topbar__section__end -->

    <!-- headar section start -->
    {% include 'partials/navbar.html' %}
    <!-- header section end -->

    <!-- Mobile Menu Start Here -->
    {% include 'partials/mobile-menu.html' %}
    <!-- Mobile Menu end Here -->

    <!-- theme fixed shadow -->
    <div>
        <div class="theme__shadow__circle"></div>
        <div class="theme__shadow__circle shadow__right"></div>
    </div>
    <!-- theme fixed shadow -->

    <!-- breadcrumbarea__section__start -->
    <div class="breadcrumbarea">

        <div class="container">
            <div class="row">
                <div class="col-xl-12">
                    <div class="breadcrumb__content__wraper" data-aos="fade-up">
                        <div class="breadcrumb__title">
                            <h2 class="heading">Log In</h2>
                        </div>
                        <div class="breadcrumb__inner">
                            <ul>
                                <li><a href="{% url 'home' %}">Home</a></li>
                                <li>Log In</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="shape__icon__2">
            <img loading="lazy" class=" shape__icon__img shape__icon__img__1" src="{% static 'img/herobanner/herobanner__1.png' %}"
                alt="photo">
            <img loading="lazy" class=" shape__icon__img shape__icon__img__2" src="{% static 'img/herobanner/herobanner__2.png' %}"
                alt="photo">
            <img loading="lazy" class=" shape__icon__img shape__icon__img__3" src="{% static 'img/herobanner/herobanner__3.png' %}"
                alt="photo">
            <img loading="lazy" class=" shape__icon__img shape__icon__img__4" src="{% static 'img/herobanner/herobanner__5.png' %}"
                alt="photo">
        </div>

    </div>
    <!-- breadcrumbarea__section__end-->

    <!-- login__section__start -->
    <div class="loginarea sp_top_100 sp_bottom_100">
        <div class="container">
            <div class="row">
                <div class="col-xl-8 col-md-8 offset-md-2" data-aos="fade-up">
                    <ul class="nav  tab__button__wrap text-center" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="single__tab__link active" data-bs-toggle="tab" data-bs-target="#projects__one" type="button">Log in</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="single__tab__link" data-bs-toggle="tab" data-bs-target="#signup" type="button">Sign up</button>
                        </li>
                    </ul>
                </div>

                <div class="tab-content tab__content__wrapper" id="myTabContent" data-aos="fade-up">

                    <div class="tab-pane fade active show" id="projects__one" role="tabpanel" aria-labelledby="projects__one">
                        <div class="col-xl-8 col-md-8 offset-md-2">

                            <div class="loginarea__wraper">
                                <div class="login__heading">
                                    <h5 class="login__title">Log In</h5>
                                    <p class="login__description">Don't have an account yet? <a href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Sign up</a>
                                    </p>
                                </div>

                                <!-- login form -->
                                <form method="POST" action="{% url 'user_login' %}">
                                    {% csrf_token %}
                                    <div class="login__form">
                                        <label class="form__label">Username</label>
                                        <input class="common__login__input" type="text" placeholder="Username" name="username" required>
                                    </div>
                                    <div class="login__form">
                                        <label class="form__label">Password</label>
                                        <input class="common__login__input" type="password" placeholder="Password" name="password" required>
                                    </div>
                                    <div class="login__form d-flex justify-content-between flex-wrap gap-2">
                                        <div class="text-end login__form__link">
                                            <a href="{% url 'password_reset' %}">Forgot your password?</a>
                                        </div>
                                    </div>
                                    <div class="login__button">
                                        <button class="default__button" type="submit">Log In</button>
                                    </div>
                                </form>
                                <!-- login form -->
                            </div>

                        </div>
                    </div>

                    <div class="tab-pane fade" id="signup" role="tabpanel" aria-labelledby="signup">
                        <div class="col-xl-8 offset-md-2">

                            <div class="loginarea__wraper">
                                <div class="login__heading">
                                    <h5 class="login__title">Sign Up</h5>
                                    <p class="login__description">Already have an account? <a href="#"
                                            data-bs-toggle="modal" data-bs-target="#registerModal">Log in</a></p>
                                </div>
                                
                                <!-- registration form -->
                                <form method="POST" action="{% url 'user_registration' %}" enctype="multipart/form-data">
                                    {% csrf_token %}
                                    <div class="row">
                                        {% for field in form %}
                                            <div class="col-xl-12" id="{% if field.name == 'session' %}session_div{% endif %}">
                                                <div class="login__form">
                                                    <label class="form__label">{{ field.label }}</label>
                                                    {{ field }}
                                                    {% if field.help_text %}
                                                        <small class="form-text text-muted">{{ field.help_text }}</small>
                                                    {% endif %}
                                                    {% for error in field.errors %}
                                                        <div class="text-danger">{{ error }}</div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>

                                    <div class="login__button mt-4">
                                        <button class="default__button" type="submit">Register</button>
                                    </div>
                                </form>
                                <!-- registration form -->
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

            <div class=" login__shape__img educationarea__shape_image">
                <img loading="lazy" class="hero__shape hero__shape__1" src="{% static 'img/education/hero_shape2.png' %}" alt="Shape">
                <img loading="lazy" class="hero__shape hero__shape__2" src="{% static 'img/education/hero_shape3.png' %}" alt="Shape">
                <img loading="lazy" class="hero__shape hero__shape__3" src="{% static 'img/education/hero_shape4.png' %}" alt="Shape">
                <img loading="lazy" class="hero__shape hero__shape__4" src="{% static 'img/education/hero_shape5.png' %}" alt="Shape">
            </div>
        </div>
    </div>
    <!-- login__section__end -->

    {% include 'partials/footer.html' %}
</main>

{% endblock %}



{% block extra_javascript %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Activate tab if URL has a hash
        const hash = window.location.hash;
        if (hash) {
            const tabTrigger = document.querySelector(`button[data-bs-target="${hash}"]`);
            if (tabTrigger) {
                const tab = new bootstrap.Tab(tabTrigger);
                tab.show();
            }
        }

        // Show session only if user_type is student
        const userTypeSelect = document.getElementById('id_user_type');
        const sessionDiv = document.getElementById('session_div');
        if (userTypeSelect && sessionDiv) {
            function toggleSession() {
                if (userTypeSelect.value === 'student') {
                    sessionDiv.style.display = 'block';
                } else {
                    sessionDiv.style.display = 'none';
                }
            }
            userTypeSelect.addEventListener('change', toggleSession);
            toggleSession();
        }
    });
</script>
{% endblock extra_javascript %}

    
